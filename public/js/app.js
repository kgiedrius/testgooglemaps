function initMap(e){directionsService=new google.maps.DirectionsService,directionsDisplay=new google.maps.DirectionsRenderer({suppressMarkers:!0}),map=new google.maps.Map(document.getElementById("map"),{zoom:6,center:e,backgroundColor:"#FFF",disableDefaultUI:!0}),directionsDisplay.setMap(map),calculateAndDisplayRoute("Kaunas")}function addMarker(e,t){new google.maps.Marker({position:e,map:map,title:t}).addListener("click",function(){calculateAndDisplayRoute(this.title)})}function calculateAndDisplayRoute(e){var t=[];$.each(routeData,function(e,a){t.push({location:a.formatted_address,stopover:!0}),addMarker(a.location,a.formatted_address)}),directionsService.route({origin:e,destination:e,waypoints:t,optimizeWaypoints:!0,travelMode:"DRIVING"},function(e,t){if("OK"===t){var a="<br><ol>",i=0,o=0;$.each(e.routes[0].legs,function(e,t){t.start_address!=t.end_address&&(a+="<li>"+t.start_address.split(",")[0]+" -> "+t.end_address.split(",")[0]+"("+t.distance.text+"/"+t.duration.text+")</li>",o+=t.duration.value,i+=t.distance.value)}),a+='</ol><br><div class="text-center">Total distance: '+Math.round(i/1e3)+"km. Total time:"+Math.round(o/3600)+"val. "+Math.round(o%3600/60)+"min </div><br><br>",$("#routeInfo").html(a),directionsDisplay.setDirections(e),google.maps.event.addListener("K","click",function(){this.setTitle("I am clicked")})}else window.alert("Directions request failed due to "+t)})}var routeData=!1,map=!1,directionsService,directionsDisplay;$("#geoDataProcessForm").on("submit",function(){var e=$(this),t=!1;window.FormData&&(t=new FormData(e[0])),$("#api-result").text("Loading..."),$.ajax({url:e.attr("action"),data:t||e.serialize(),cache:!1,contentType:!1,processData:!1,type:"POST",success:function(e,t,a){$("#api-result").text(JSON.stringify(e))}})}),$("#showMapForm").on("submit",function(){var e=$(this),t=!1;window.FormData&&(t=new FormData(e[0])),$.ajax({url:e.attr("action"),data:t||e.serialize(),cache:!1,contentType:!1,processData:!1,type:"POST",success:function(e,t,a){routeData=e,$(".bs-example-modal-lg").modal()}})}),$(".bs-example-modal-lg").on("shown.bs.modal",function(e){initMap({lat:55.2881309,lng:23.9577279})});